
<html>
<head>
<title>打印文章</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<link href="../admin/admin_STYLE.CSS" rel="stylesheet" type="text/css">
<script language="JavaScript" type="text/JavaScript">
function resizepic(thispic)
{
if(thispic.width>700) thispic.width=700;
}
//双击鼠标滚动屏幕的代码
var currentpos,timer;
function initialize()
{
timer=setInterval ("scrollwindow ()",30);
}
function sc()
{
clearInterval(timer);
}
function scrollwindow()
{
currentpos=document.body.scrollTop;
window.scroll(0,++currentpos);
if (currentpos !=document.body.scrollTop)
sc();
}
document.onmousedown=sc
document.ondblclick=initialize
</script></head>
<body leftmargin=0 topmargin=0 leftmargin="2" topmargin="0" marginwidth="0" marginheight="0" oncontextmenu="return false" ondragstart="return false" onselectstart ="return false" onselect="document.selection.empty()" oncopy="document.selection.empty()" onbeforecopy="return false" onmouseup="document.selection.empty()">
<noscript><iframe src=*></iframe></noscript>
<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" style="word-break:break-all">
  <tr> 
    <td height="20" align="right" bgcolor='#E1E7F2'><a href="javascript:window.print()"><img src=../Images/printpage.gif alt="打印本文" width="14" height="14" border="0" align=absmiddle>&nbsp;打印本文</a>&nbsp;&nbsp;<img src=../Images/pageclose.gif alt="关闭窗口" width="14" height="14" border="0" align=absmiddle>&nbsp;<a href="javascript:window.close()">关闭窗口</a>&nbsp;&nbsp;
	</td>
  </tr>
	<tr><td>
      <p align="center"><font size='4'><b>电话通讯设计经验</b></font>
	</td></tr>
	<tr><td align="center">
            作者：佚名&nbsp;&nbsp;&nbsp;&nbsp;文章来源：<a href='http://www.newmaker.com'>不详</a>&nbsp;&nbsp;&nbsp;&nbsp;点击数：2552&nbsp;&nbsp;&nbsp;&nbsp;更新时间：2005-9-13&nbsp;&nbsp;&nbsp;&nbsp;文章录入：admin&nbsp;&nbsp;&nbsp;&nbsp;责任编辑：admin
	</td>
	</tr>
	<tr>
	  <td><hr align=center width=100% color=#8EA7CD noShade size=1>
</td>
  </tr>
	<tr><td>
		  采用电话线进行通信的过程简单介绍如下：<BR>一、发射方：<BR>1，模拟摘机；<BR>2，自动拨号；<BR>3，检测对方是否摘机，是，转4。否，转错误处理；<BR>4，单片机控制DTMF发送器把要发送的数据发送到线路。<BR>5，......<BR>二、接收方：<BR>1，检测振铃信号；<BR>2，模拟摘机；<BR>3，用8870接收对方用DTMF方式发过来的数据；<BR>4，单片机根据通信协议处理接收到的数据和命令。<BR>********************************************<BR>你的系统不能译码的可能原因：<BR>1,发射方：<BR>a).是采用单片机或其他单音频发生器电路进行合成产生的DTMF信号，造成DTMF信号的频率误差过大或者波形失真，这种情况下请立即采用有4线CPU数据接口的DTMF专用发号芯片，修改原电路设计。<BR>b).耦合到线路的DTMF信号电平过低，致使接收端MT8870得到的DTMF信号信噪比过低，导致译码失败。<BR>c).DTMF信号的最小持续时间应该大于50ms，码间休止时间也应大于50ms。有的设计者为了提高通信速率，采用减小上述时间的做法是不科学的，这样做的结果会减低通信的可靠性。<BR>2,接收端：<BR>a).输入耦合电路设计不当，使得MT8870的输入电平不合适。<BR>b).电路板上有其他干扰信号存在。<BR>c).电源退耦不好。<BR>d).16、17脚的外围电路参数选择不当，请严格按照典型应用电路中的参数选择元件。<BR>***************************<BR>关于mt8880设计要点：<BR>1、输入电路正确否<BR>2、寄存器初始化顺序(按照datasheet提供的例子来)<BR>3、上电后要延时150ms，非常重要<BR>4、8880的CPU接口和51单片机配合时要注意时序 <BR>***************************<BR>电话正常，但是通过总机转播时不正常，可能有以下原因：<BR>1.总机有二次拨号音，其通道电阻太大、噪声太大，电话的DTMF被衰减、失真，交换机难以<BR>辨认；<BR>2.总机无二次拨号音，因其接通交换机瞬间有较大的电压降落，以至交换机误认为脉冲拨号<BR>“1”，对后续的DTMF拨号不与识别；<BR>3.电话的指标临界，环境稍微变化就无法工作。<BR>至于何种原因，必须在电话分析仪上面测试，从结果是分析。目前，主要检查DTMF放大电路<BR>的状态、频率特性，Pulse电路的通态电阻（应该相当于饱和导通，否则对P/T拨号均有极大<BR>的影响）。不过，说了这么多废话都是瞎猜，你提的问题属于糊里糊涂的一种，能够理解已<BR>不错，能够解决当属神！希望能对总机的性能、电话的通断电流电压、电话的拨号方式、正<BR>常电话比较结果等等做描述，才有利于大家解答！另外，随手拿一台电话照抄，其拨号都应<BR>该没问题！ <BR>****************************<BR>联机码用电话机号码以外的码<BR><BR>这是为了防止误打进来或有意捣乱的电话扰乱系统的工作。<BR>为了提高速度，要采用固定码长，建议用采用D或E做开始码，用F做结束码，联机码也要用电话机号码以外的码，主叫显示DTMF有的信号就是这样。<BR>&nbsp;&nbsp; 一般的电话机因有“#”和“*”键，可以拨出“1011”和“1100”码，所以采用F为结束码可以达到“电话机号码以外的码”的效果。但是，开始码为0时，在DTMF码里是1010即是电话机的0键就避不开“电话机号码以外的码”了，所以我觉的开始码采用D或E为好。<BR>****************************<BR>DTMF信号的产生原理****zhongyao!<BR><BR>双音频信号是两个正弦波信号的叠加，选定两个频率f1和f2后很容易得到这种信号的数学表达式：A*sin(2*Pi*f1*t)+A*sin(2*Pi*f2*t)。<BR><BR>假设我们用一个合适的采样频率对这个信号进行A/D转换，则很容易计算出每一个采样点的A/D值，而如果将这些采样值形成一张表，在单片机里用同样的采样频率将这张表中的数值用D/A转换器输出，不就是双音频信号吗？<BR><BR>当然上文只是为了说明DTMF信号的产生原理，如果真的使用传统的D/A转换器那还不如用一片专用的DTMF发生器。实际应用中常用1bit的DM编码来实现上述的A/D和D/A过程，其中A/D过程可以在PC机上完成，用程序生成对应每一个DTMF信号的DM编码表（当然这一步你愿意用手工做也是可以的），D/A过程在单片机上完成，因为是1bit编码，所以只需占用一根I/O口线，外接一个简单的积分器和一个低通滤波器即可。<BR>******************************<BR>电信是如何实现实时程控的？<BR><BR>就是在听到语音提示的同时可以按下DTMF发射键，服务器准确接收到DTMF信号，做出相印操作。关键问题在于语音信号对DTMF的干扰。<BR><BR>1、DTMF信号需要规定的持续时间才能被解码，所以语音信号造成的信号能被滤除。<BR>2、接收端均有消侧音电路，交换机发出的信号音不会或很少影响到DTMF解码，交换机解码端仅接收对方发来的信号。<BR>3、电话机标准规定了发送DTMF信号时必须对MIC静音(重要)；发码时，MIC信号不会被发送。<BR>4、DTMF译码并非实现程控的关键，或者说难点，这是基本要求，要实现程控，有一大锅的事要做。<BR>并且DTMF解码块中有相应的滤波电路及信号的积分电路，语音干扰对其影响很小。<BR>*******************************<BR>电话拨号后如何检测接通？<BR><BR>电话拨号后,若接通会有回铃音,对方摘机回铃音即消失.<BR>若未接通不会有回铃音或只有忙音.<BR>你可在拨号后检测是否有回铃音,若没有或是忙音则重拨.<BR>若是回铃音则继续检测,直到检测到不是回铃音则对方已摘机<BR><BR>对方摘机后,会有16KHZ或12KHZ或反极信号,可用一带通滤波电路检测 <BR>回铃声是450hz信号 <BR>可用LM567检测450HZ<BR>有的地方交换机发出的不是准确的450HZ信号,有的相差很大,最大相差可达50HZ,所以必须要在线调试<BR><BR>反极信号最可靠，但要申请，好象还要另交费。 <BR>就是电信不向普通电话提供反极信号的，而公用电话记费器是交换机返回了反极信号所以能准确判断是否接通，但是有个白痴的问题请教高手们，为什么叫反极信号呢？用带通滤波器来检测么？<BR>挂机时假如线路为a +, b-,接通后，交换机会让线路变成b+,a- <BR><BR>那个反极时间能持续多久？<BR>通话双方有一方挂机 <BR><BR>反极信号和被叫端局送来的被叫摘机信号都是用来记费的，但应用的场合是不一样的。<BR><BR>&nbsp;&nbsp; 我不是用的MT8880,是使用单片机软件实现的,这样灵活性很强,即只要有信号音来就固定检测1.2秒,由LM567对信号音整形,若为拨号音LM567输出低电平,且计数值为0(此时也太有可能是长途通知音);若为忙音计数值为3或2;若为静音LM567输出高电平,且计数值为0;若为话音计数值&gt;3;若为回铃音计数值为1;<BR>&nbsp;&nbsp; 拨号完了,单片机会立即起动1.2秒的回铃音检测,若不是回铃音,则会立即挂机重拨,若是回铃音,则继续检测,第二个1.2秒回铃音检测在3.8秒后进行,以此类推直到第n个1.2秒回铃音检测到不是回铃音了就是对方摘机了,这时可播放语音.<BR>&nbsp;&nbsp; 我这种方式检测时间是不固定的,若对方正好在1.2秒后摘机,则要延时<BR>5秒才检测到,若在下一个1.2秒检测前一瞬间摘机,则只需1.2秒就可检测到,所以检测时间是1.2--5秒.而MT8880是固定的5秒检测.<BR>********************************<BR>电话局向用户传送的信号<BR><BR>最常用的有以下几种：<BR>1、振铃信号：用来呼叫被叫用户。铃流为25±3Hz正弦波，谐波失真不大于10％，输出电压有效值90+-15V，振铃采用5s断续，即一秒送，4s断，断、续时间偏差不超过±10％。<BR>2、拨号音－：用来通知主叫用户可以拨号。拨号音采用频率为450±25Hz的交流电源，发送电平为-10±3dBm，是连续的信号音。<BR>3、回铃音－：表示被叫用户处于被振铃状态，采用频率为450±25Hz的交流电源，发送电平为-10±3dBm，它是5s断续的信号音，即1s送，4s断，与振铃音一致。<BR>4、忙音－：表示本次接续遇到机线忙或被叫用户忙，采用频率为450±25Hz的交流电源，发送电平为-10±3dBm，它是0.7断续的信号音，即0.35送，0.35断。久叫不应90s后送忙音。<BR>5、长途通知音－：用于通知正在进行市内通话的用户有长途电话，采用频率为450±25Hz的交流电源，发送电平为-20±3dBm，它是1.2s不等间隔断续的信号音，即0.2s送，0.2s断，0.2s送，0.6断。<BR>6、空号音：用于通知主叫用户，所呼叫的被叫号码为空号或受限制的号码，采用频率为450±25Hz的交流电源，发送电平为-10±3dBm，它是1.4s不等间隔断续的信号音，即重复三次0.1s送、0.1s断后，0.4s送，0.4断，步进制电话局遇空号用忙音代替空号音。<BR>7、排队等待音－：用于具有排队性能的接续，以通知主叫用户等待应答，采用频率450±25Hz的交流电源，发送电平为-10±3dBm，需要时可用回铃音或用录音通知，不另设专用信号音。<BR>8、证实音：它是由立去台话务员自发自收的信号，用于核实主叫用户号码的正确性，采用频率为950±50Hz的交流电源，发送电平为-20±3dBm，发连续信号音。<BR>9、催挂音＋：它是由测量台发送给久不挂机用户的信号，其目的是通知用户挂机，采用频率950±50Hz的交流电源，发送电平为0～25dBm，发送连续信号音，响度变化分五级，由最低级逐步升高。<BR>&nbsp;&nbsp;&nbsp; 上述各种信号中，除铃流外，根据信号音种类，信号音源为450±25Hz或950±50Hz，谐波失真不大于10％；各种信号音断、续偏差分别不得超过10%。<BR>**************************<BR>**************************<BR>电话主叫识别信息传送及显示<BR><BR>本页主要讨论电话主叫识别信息传送及显示功能的技术，并结合东进TC-08ACID卡探讨主叫识别的实现和常见错误的解决办法。这里不讨论数字程控交换中采用局间信令传送主叫识别信息显示的内容。<BR><BR>东进公司支持主叫识别的模拟卡产品包括：TC-08A CID是支持主叫识别功能的 8 线语音处理卡；TC-08R是集成 了主叫识别功能的录音卡；D080A是支持主叫识别的8线DSP语音处理卡（测试中）；D040A是支持主叫识别的4线 DSP语音处理卡（开发中） 。<BR><BR>主叫识别的功能和业务基本要求：【主叫识别信息是向被叫电话用户提供的服务，可以向被叫用户终端设备发送主叫号码，主叫用户姓名，呼叫日期，时间等主叫识别信息】<BR><BR>实现主叫识别的基本方法是发端交换机将主叫号码等通过局间信令系统（例如7号信令系统）传送给终端交换机。终端交换机将主叫识别信息以移频键控（FSK）的方式送给被叫用户。这里我们可以看到，FSK方式是标准的主叫识别信息传送方式，所谓的DTMF方式是非标准的。不过东进公司所有产品对这两种方式都予以支持。<BR><BR>终端交换机将主叫识别信息传送给被叫用户终端设备是在用户终端挂机的状态下进行的。主叫信息在第一次振铃和第二次振铃间隔期间传送。<BR><BR>接收主叫的要求：用户作为被叫，在接收来话时可以要求提供CID业务，也可以不要求提供此业务。不申请提供此业务的用户收不到主叫识别信息。<BR><BR>发送主叫的业务：用户可以申请向被叫用户终端设备显示主叫号码、允许单次呼叫不显示；用户可以申请不向 被叫用户终端设备发送主叫信息、允许单次呼叫显示；用户可以申请所有拨号均不向被叫发送主叫信息的业 务；拨打110、119等特服号码均应发送主叫信息。<BR><BR>主叫显示内容：至少包括主叫号码（包括长途区号）、日期（xx月xx日）、时间（xx时xx分）。随着服务的扩展，发送的内容可以逐步增加。其中主叫号码由发端交换机发送，日期和时间是由终端交换机发送。所以在收不到主叫信息时要先考虑到是否对方交换机未发送主叫号码。<BR><BR>主叫识别信息数据传送协议：<BR><BR>主叫识别信息数据的传送时序：先送铃流（第一次振铃），振铃结束0.5-1.5秒之后开始传送主叫数据，传送数据的时间应不大于2.9秒。主叫数据传送结束200毫秒后在送第二次振铃铃流。<BR>在主叫数据传送过程中，如果用户摘机，则传送停止且呼叫处理正常进行。<BR><BR>主叫识别信息数据的格式：分为两种，单数据消息格式（SDMF）和复合数据消息格式（MDMF）；前者的结构简单，可容纳的信息内容较少，如主叫号码，日期时间等；后者的结构胶复杂，可容纳信息长度较长，出前者的内容外还可传送主叫用户的姓名。 <BR><BR>单数据消息格式：由消息头和消息体组成。<BR>1、消息头由消息类型和消息长度组成。它们均为 8bits 的字。消息类型的值用来识别消息的特征。消息长度 指明后面所跟得消息字的长度。<BR>2、消息体包括交换机传送给终端用户的信息，可以容纳 1-255 个8比特的消息字。每个字用8比特带校验位的7 位编码字符集表示。<BR><BR>复合数据消息格式：也由消息头和消息体组成。不同的是，复合数据的消息体由一个或多个小的消息（称为参 数消息）组成。参数消息同样具有参数头和参数体。参数头包括参数类型和参数长度，它们均为8比特字。参数 类型值用来识别后续参数字。参数长度指明参数体中参数字的数目。复合数据消息格式允许不同特征产生的不 同消息在同一个帧中传递。<BR><BR>数据的定义：<BR><BR>1、消息类型字<BR>消息类型字的值（16进制数表示）从00-FF可以定义256种不同特征的消息。其中值00000100在单数据格式里表 示主叫号码传送信息，10000000在符合数据格式里表示呼叫建立。<BR><BR>2、消息长度字<BR>表示消息体中的消息字的数目。16进制数，00-FF。<BR><BR>3、参数类型字<BR>16进制数，00-FF，可表示256种不同特征的参数。<BR><BR>4、参数长度字<BR>表示参数体中参数字的数目。16进制数，00-FF。<BR><BR>5、消息字和参数字<BR>单数据格式按照 消息类型（如：04H）、消息长度、消息字、月、日、时、分、主叫号码（或O或P） 顺序排列 组成。<BR>复合数据格式按照 消息类型（如：80H）、消息长度、参数消息（日期，时间）、参数消息（主叫号码，或O或 P）、参数消息（主叫姓名，或O或P）的顺序排列组成。<BR>所有的消息字和参数字都有奇偶校验位（即比特位7），采用奇校验方式。<BR>差错校验：消息后附有校验字供发送器和接收器校验消息的正确性。消息字算法是将消息数据按256的模求和取 补来得到校验字。<BR>*************************************<BR>拨号音：450hz（误差25hz）正弦波，连续<BR>忙音：450hz（误差25hz）正弦波，0.35秒通0.35秒断<BR>回铃音：450hz（误差25hz）正弦波，3.4秒通1.6秒断<BR><BR>将mt8880的CP/_IRQ脚接到单片机的t1脚，5秒钟(只能是5秒,因为MT8880是固定5秒检测)计数，<BR>根据数值作判断【忙音】【拨号音】【回铃音】【话音】【静音】<BR>
<SCRIPT language=&#106avascript>
<!--
var SymRealOnLoad;
var SymRealOnUnload;

function SymOnUnload()
{
  window.open = SymWinOpen;
  if(SymRealOnUnload != null)
     SymRealOnUnload();
}

function SymOnLoad()
{
  if(SymRealOnLoad != null)
     SymRealOnLoad();
  window.open = SymRealWinOpen;
  SymRealOnUnload = window.onunload;
  window.onunload = SymOnUnload;
}

SymRealOnLoad = window.onload;
window.onload = SymOnLoad;

//-->
</SCRIPT>
	</td>
  </tr>
  <tr> 
    <td height="20" align="right" bgcolor='#E1E7F2'><a href="javascript:window.print()"><img src=../Images/printpage.gif alt="打印本文" width="14" height="14" border="0" align=absmiddle>&nbsp;打印本文</a>&nbsp;&nbsp;<img src=../Images/pageclose.gif alt="关闭窗口" width="14" height="14" border="0" align=absmiddle>&nbsp;<a href="javascript:window.close()">关闭窗口</a>&nbsp;&nbsp;
	</td>
  </tr>
</table>
</body>
</html>
